# ============================================
# Vercel è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆä»£æ›¿æ¡ˆï¼‰
# GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
# 
# â€» Cloudflare Pagesã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ä¸è¦
# ============================================

name: Deploy to Vercel

on:
  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ç„¡åŠ¹åŒ–ï¼ˆæ‰‹å‹•å®Ÿè¡Œã®ã¿ï¼‰
  workflow_dispatch:
  # mainãƒ–ãƒ©ãƒ³ãƒã¸ã®pushã§ã‚‚å®Ÿè¡Œã™ã‚‹å ´åˆã¯ä»¥ä¸‹ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã™
  # push:
  #   branches:
  #     - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # ============================================
      # 1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      # ============================================
      - name: Checkout repository
        uses: actions/checkout@v4

      # ============================================
      # 2. Vercel CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
      # ============================================
      - name: Install Vercel CLI
        run: npm install -g vercel@latest

      # ============================================
      # 3. Vercel ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒªãƒ³ã‚¯
      # ============================================
      - name: Pull Vercel Environment Information
        run: vercel pull --yes --environment=production --token=${{ secrets.VERCEL_TOKEN }}
        env:
          VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
          VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}

      # ============================================
      # 4. ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã«ãƒ‡ãƒ—ãƒ­ã‚¤
      # ============================================
      - name: Deploy to Vercel
        run: vercel deploy --prod --token=${{ secrets.VERCEL_TOKEN }}
        env:
          VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
          VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}

      # ============================================
      # 5. ãƒ‡ãƒ—ãƒ­ã‚¤çµæœã‚’å‡ºåŠ›
      # ============================================
      - name: Output deployment URL
        run: |
          echo "ğŸ‰ Deployment completed!"
          echo "ğŸ“± Check your Vercel dashboard for the deployment URL"
